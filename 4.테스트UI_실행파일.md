# HyurimBot 테스트 UI 및 실행 파일 가이드

## 1. 시스템 개요

### 1.1 구현된 UI 시스템
HyurimBot은 다음 3개의 사용자 인터페이스를 제공합니다:

1. **관리자 대시보드** (Flask 기반) - 데이터 수집 및 관리
2. **AI 추천 API** (Flask REST API) - 추천 서비스 백엔드  
3. **통합 웹 인터페이스** (HTML/JavaScript) - 사용자 추천 서비스

### 1.2 실행 환경 요구사항
```
- Python 3.8+
- Node.js 16+ (Playwright 브라우저 자동화)
- SQLite 데이터베이스 (hyurimbot.db)
- 가상환경 (venv 또는 conda)
- 웹 브라우저 (Chrome/Firefox/Edge)
```

## 2. 실행 방법

### 2.1 환경 설정
```bash
# 1. 프로젝트 디렉토리로 이동
cd /mnt/c/Users/yurin/OneDrive/문서/DEV/Hyurim_v1/hyurimbot/2.구현코드_GitHub/

# 2. 가상환경 활성화
source venv/bin/activate  # Linux/Mac
# 또는
venv\Scripts\activate     # Windows

# 3. 의존성 확인
pip list | grep -E "(flask|faiss|sentence|playwright)"
```

### 2.2 메인 시스템 실행
```bash
# 통합 시스템 실행 (포트 8081)
python integrated_app.py

# 실행 성공 시 다음 메시지 출력:
# ✅ HyurimBot 벡터 검색 엔진 로드 완료  
# ✅ 기본 추천 엔진 로드 완료
# HyurimBot 통합 시스템을 시작합니다...
# 관리자 계정: admin / hyurimbot2025
# 데이터 수집 대시보드: http://localhost:8081/admin/data-collection
```

### 2.3 개별 테스트 실행
```bash
# 기본 추천 엔진 테스트
python test_basic_recommendation.py

# 데이터베이스 통합 테스트  
python test_database_integration.py

# 통합 시스템 테스트
python test_integrated_system.py
```

## 3. 관리자 대시보드 (데이터 수집 시스템)

### 3.1 접속 정보
- **URL**: http://localhost:8081/admin/data-collection
- **로그인**: http://localhost:8081/login
- **계정**: admin / hyurimbot2025

### 3.2 주요 화면 구성

#### 3.2.1 메인 대시보드 화면
```
┌─────────────────────────────────────────────────────────┐
│ 🌲 HyurimBot 관리자 대시보드                              │
├─────────────────────────────────────────────────────────┤
│ 탭: [자연휴양림] [숙박시설] [할인정책]                     │
│                                                         │
│ 📊 현재 수집 현황:                                       │
│ • 휴양림: 5개 (목표: 199개)                              │  
│ • 숙박시설: 93개                                        │
│ • 편의시설: 3개 (구현 중)                                │
│ • 할인정책: 87개                                         │
└─────────────────────────────────────────────────────────┘
```

#### 3.2.2 숙박시설 관리 화면
```
┌─────────────────────────────────────────────────────────┐
│ 📋 숙박시설 관리                                         │
├─────────────────────────────────────────────────────────┤
│ 휴양림명 | 시설명 | 유형 | 인원 | 가격 | 상세데이터수집   │
│ 교래     | 숲속의초가1 | 초가동 | 6명 | 75,000원 | 🟢 상세 │
│ 교래     | 휴양관1    | 휴양관 | 8명 | 95,000원 | 🟡 기본  │
│ 절물     | 편백하우스  | 펜션  | 10명 | 120,000원| 🟡 기본 │
│ ...                                                     │
│                                                         │
│ [🔄 기본 데이터 수집] [📊 상세 데이터 수집] [💾 엑셀 다운로드] │
└─────────────────────────────────────────────────────────┘
```

#### 3.2.3 실시간 크롤링 진행 화면  
```
┌─────────────────────────────────────────────────────────┐
│ 🕷️ 웹 크롤링 진행 상황                                   │
├─────────────────────────────────────────────────────────┤
│ 현재 작업: 숲속의초가 1 (6인실) 상세 데이터 수집          │
│ 진행률: ████████░░ 80%                                   │
│                                                         │
│ 📝 크롤링 로그:                                          │
│ [15:17:52] 팝업 상세 정보 추출 시작                       │
│ [15:17:53] ✅ 매칭된 시설 찾음: 숲속의초가 1              │
│ [15:17:54] 🎯 편의시설 10개 항목 수집 완료                │
│ [15:17:55] 💰 가격 정보 4개 구간 수집 완료                │
│ [15:17:56] ✅ 데이터 업데이트 완료                        │
└─────────────────────────────────────────────────────────┘
```

### 3.3 관리자 기능

#### 3.3.1 데이터 수집 기능
1. **기본 데이터 수집**: 시설명, 인원, 가격 등 필수 정보
2. **상세 데이터 수집**: 편의시설, 객실구성, 예약규칙 등
3. **할인정책 수집**: 다자녀, 장애인, 지역주민 할인 정보
4. **실시간 모니터링**: 크롤링 진행 상황 실시간 추적

#### 3.3.2 데이터 관리 기능  
1. **데이터 현황 조회**: 테이블별 데이터 개수 및 상태
2. **품질 검증**: 필수 필드 누락 여부 자동 검사
3. **백업 및 복원**: 데이터베이스 백업 파일 생성
4. **로그 관리**: 크롤링 성공/실패 이력 관리

## 4. AI 추천 시스템 (사용자 인터페이스)

### 4.1 접속 정보
- **메인 페이지**: http://localhost:8081/
- **API 엔드포인트**: http://localhost:8081/api/recommend
- **실행 방법**: 관리자 대시보드와 동일한 서버에서 제공

### 4.2 사용자 추천 화면

#### 4.2.1 메인 검색 화면
```
┌─────────────────────────────────────────────────────────┐
│ 🌲 HyurimBot - AI 자연휴양림 추천                        │
├─────────────────────────────────────────────────────────┤
│ 어떤 휴양림 여행을 계획하고 계시나요?                      │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 4인 가족과 함께 제주도에서 힐링하고 싶어요            │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 🔍 상세 조건 (선택사항)                                   │
│ • 인원: [ 4명 ▼ ]  • 예산: [ 10만원대 ▼ ]               │
│ • 지역: [ 제주 ▼ ]  • 유형: [ 전체 ▼ ]                  │
│                                                         │
│                    [🔍 추천받기]                         │
└─────────────────────────────────────────────────────────┘
```

#### 4.2.2 추천 결과 화면
```
┌─────────────────────────────────────────────────────────┐
│ 🎯 맞춤 추천 결과 (5개)                                   │
├─────────────────────────────────────────────────────────┤
│ 1위. 🏠 숲속의초가 1 (교래자연휴양림)         ⭐ 89.2%   │
│     초가동 | 6명 | 75,000원 → 💰 52,500원 (30% 할인)    │
│     "전통 초가 체험 + 가족 친화적 + 할인 혜택"            │
│     🏠 방1, 거실, 주방 | 🔌 에어컨, TV, 냉장고          │
│     📍 제주시 조천읍 교래리                              │
│                                                         │
│ 2위. 🏠 휴양관 2 (절물자연휴양림)            ⭐ 82.7%   │
│     휴양관 | 8명 | 95,000원                             │
│     "넓은 공간 + 편의시설 완비 + 산림욕장 인접"           │
│     🔌 전자레인지, 전기레인지, 취사도구                   │
│                                                         │
│ [상세보기] [예약하기] [비교하기]                           │
└─────────────────────────────────────────────────────────┘
```

### 4.3 API 테스트

#### 4.3.1 추천 API 요청 예시
```bash
# REST API 직접 호출 테스트
curl -X POST http://localhost:8081/api/recommend \
  -H "Content-Type: application/json" \
  -d '{
    "query": "4인 가족 제주 힐링 숙소",
    "preferences": {
      "capacity": 4,
      "price_max": 150000,
      "location": "제주",
      "top_k": 5
    }
  }'
```

#### 4.3.2 API 응답 예시
```json
{
  "success": true,
  "query": "4인 가족 제주 힐링 숙소",
  "total_results": 5,
  "execution_time_ms": 234,
  "recommendations": [
    {
      "accommodation_id": 1,
      "facility_name": "숲속의초가 1 (6인실)",
      "forest_name": "교래자연휴양림",
      "facility_type": "초가동",
      "capacity_standard": 6,
      "price_off_weekday": 75000,
      "similarity_score": 0.892,
      "recommendation_reason": "전통 체험 | 가족 친화적 | 적정 가격",
      "amenities": "에어컨;TV;냉장고;전자레인지;전기레인지"
    }
  ]
}
```

## 5. 테스트 실행 결과

### 5.1 데이터베이스 통합 테스트 결과
```bash
$ python test_database_integration.py

🗄️ HyurimBot 데이터베이스 통합 테스트 시작
==================================================
🧪 데이터베이스 연결 테스트 중...
✅ 데이터베이스 연결 성공: 데이터베이스 연결 성공 (크기: 0.25MB)

🧪 테이블 구조 테스트 중...  
✅ 테이블 구조 성공: 테이블 구조 확인: 16개 테이블, 핵심 테이블 컬럼 수: {'forests': 19, 'accommodations': 22, 'facilities': 21}

🧪 데이터 가용성 테스트 중...
✅ 데이터 가용성 성공: 데이터 가용성 확인: {'forests': 5, 'accommodations': 93, 'facilities': 3}

🧪 데이터 품질 테스트 중...
✅ 데이터 품질 성공: 데이터 품질 검사 통과

🧪 샘플 데이터 조회 테스트 중...
✅ 샘플 데이터 조회 성공: 샘플 데이터 조회 성공: 5개 샘플

🧪 검색 시뮬레이션 테스트 중...
✅ 검색 시뮬레이션 성공: 검색 시뮬레이션 성공: 가족용 10개, 커플용 0개

🧪 AI 데이터 포맷 테스트 중...
✅ AI 데이터 포맷 성공: AI 데이터 포맷 확인: 평균 텍스트 길이 97자, 가격 정보 100.0%

==================================================
📊 데이터베이스 테스트 결과
전체: 7
성공: 7 ✅
실패: 0 ❌  
성공률: 100.0%

🎉 데이터베이스 통합 테스트 모두 통과!
💡 데이터베이스가 AI 추천 시스템과 통합할 준비가 되었습니다.
```

### 5.2 기본 추천 엔진 테스트 결과
```bash
$ python test_basic_recommendation.py

🤖 HyurimBot 기본 추천 시스템 테스트 시작
============================================================
📦 93개 숙박시설 데이터 로드 완료
✅ 추천 엔진 초기화 완료 (93개 시설)

📋 테스트 1: 자연어 검색 - '가족 여행 펜션 편의시설'
  1위. 휴양관 1 (교래자연휴양림)
      유형: 휴양관, 인원: 8명
      가격: 95,000원, 점수: 0.245
      편의시설: TV;냉장고;에어컨;전자레인지...

  2위. 펜션형시설 A (절물자연휴양림)  
      유형: 펜션, 인원: 6명
      가격: 110,000원, 점수: 0.198

📋 테스트 2: 지역 필터링 - '제주' 지역
  1위. 숲속의초가 1 (교래자연휴양림)
      지역: 제주특별자치도, 점수: 0.156

📋 테스트 3: 인기 숙박시설 추천
  1위. 숲속의초가 1 (교래자연휴양림)
      유형: 초가동, 인기도: 0.425

📊 추천 시스템 통계
  • 총 숙박시설: 93개
  • 시설 유형별 분포:
    - 휴양관: 62개
    - 초가동: 8개  
    - 펜션형: 18개
    - 콘도형: 3개

🎉 기본 추천 시스템 테스트 완료!
```

### 5.3 통합 시스템 테스트 결과
```bash
$ python test_integrated_system.py

🤖 HyurimBot 통합 시스템 테스트 시작
============================================================
✅ 추천 엔진 초기화 완료 (93개 시설)

📋 테스트 1: 4인 가족을 위한 넓은 객실 추천
   쿼리: '4인 가족 넓은 객실'
   선호도: {'capacity': 4, 'price': 100000}
   🎯 5개 추천 결과:
     1위. 숲속의초가 1 (교래자연휴양림)
         유형: 초가동, 인원: 6명, 가격: 75,000원
         점수: 0.187

📋 테스트 2: 편의시설이 완비된 펜션
   🎯 3개 추천 결과 성공

📋 테스트 3: 조용한 휴양을 위한 숙박시설  
   🎯 4개 추천 결과 성공

📊 시스템 상태
   • 총 숙박시설: 93개
   • 평균 가격: 108,247원

🔄 API 시뮬레이션 테스트
=====================================
📤 API 요청: {
  "query": "4인 가족 넓은 객실",
  "preferences": {
    "capacity": 4,
    "price": 100000,
    "top_k": 5
  }
}

📥 API 응답: {
  "success": true,
  "total_results": 5,
  "recommendations": [...]
}
✅ API 시뮬레이션 성공!

🎉 통합 시스템 테스트 완료!
```

## 6. 실행 시 주의사항

### 6.1 시스템 요구사항
```bash
# 필수 포트 확인
netstat -tulpn | grep :8081  # 포트 8081 사용 여부 확인

# 메모리 사용량 확인 (권장 최소 2GB)
free -h

# Python 패키지 의존성 확인
pip check
```

### 6.2 자주 발생하는 오류 및 해결방법

#### 6.2.1 데이터베이스 관련 오류
```bash
# 오류: "no such column: a.provided_items"
# 해결: 이미 수정됨, embedding_model.py에서 해당 컬럼 제거

# 오류: "database is locked"  
# 해결: 다른 프로세스가 DB 사용 중인지 확인
lsof database/hyurimbot.db
```

#### 6.2.2 Playwright 관련 오류
```bash
# 오류: "No module named 'playwright'"
# 해결: Playwright 재설치
pip install playwright==1.55.0
playwright install chromium

# 오류: "Browser is already in use"
# 해결: 브라우저 프로세스 종료 후 재시작
pkill -f chromium
```

#### 6.2.3 FAISS/BERT 관련 오류  
```bash
# 오류: "❌ 벡터 검색 엔진 초기화 실패"
# 해결: sentence-transformers 설치 (선택사항)
pip install sentence-transformers

# 폴백 시스템 작동 확인
# "🔄 기본 추천 엔진으로 폴백" 메시지 확인
```

### 6.3 성능 모니터링
```bash
# CPU/메모리 사용량 실시간 모니터링
htop

# 로그 파일 실시간 확인
tail -f nohup.out

# API 응답 속도 테스트
time curl -X POST http://localhost:8081/api/recommend \
  -H "Content-Type: application/json" \
  -d '{"query":"test"}'
```

## 7. 배포 및 운영 가이드

### 7.1 로컬 개발 환경
```bash
# 개발 모드 실행
export FLASK_ENV=development
python integrated_app.py

# 디버그 모드 활성화
export FLASK_DEBUG=1
```

### 7.2 운영 환경 배포
```bash
# 운영 모드 실행  
export FLASK_ENV=production
nohup python integrated_app.py > hyurimbot.log 2>&1 &

# 프로세스 상태 확인
ps aux | grep integrated_app.py

# 로그 모니터링
tail -f hyurimbot.log
```

### 7.3 백업 및 복구
```bash
# 데이터베이스 백업
cp database/hyurimbot.db database/hyurimbot_backup_$(date +%Y%m%d).db

# 캐시 파일 백업  
tar -czf embeddings_backup.tar.gz data/embeddings/

# 전체 시스템 백업
tar -czf hyurimbot_backup_$(date +%Y%m%d).tar.gz \
  --exclude='venv' --exclude='__pycache__' \
  --exclude='*.log' .
```

## 8. 향후 개선 계획

### 8.1 UI/UX 개선
1. **Streamlit 완전 통합**: 현재 Flask 기반 → Streamlit 네이티브 UI  
2. **모바일 반응형**: Bootstrap → 모바일 최적화 디자인
3. **실시간 업데이트**: WebSocket 기반 실시간 크롤링 진행 표시
4. **사용자 개인화**: 로그인 시스템 + 선호도 학습

### 8.2 기능 확장
1. **할인정책 완전 통합**: 사용자별 할인 혜택 자동 적용
2. **예약 시스템 연동**: 추천 → 예약까지 원스톱 서비스  
3. **리뷰 시스템**: 사용자 후기 기반 추천 품질 개선
4. **다국어 지원**: 영어/중국어/일본어 인터페이스

### 8.3 성능 최적화
1. **캐싱 시스템**: Redis 기반 API 응답 캐싱
2. **로드밸런싱**: nginx + gunicorn 멀티 프로세스
3. **CDN 연동**: 정적 파일 배포 최적화
4. **모니터링**: Prometheus + Grafana 성능 대시보드

---

**문서 버전**: 1.0  
**작성일**: 2025년 9월 11일  
**테스트 환경**: Ubuntu 20.04 LTS, Python 3.9.7  
**다음 업데이트**: 통합 시스템 안정화 완료 후